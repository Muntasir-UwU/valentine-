<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rose Day</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://unpkg.com/lenis@1.1.18/dist/lenis.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,200..800&display=swap');

        :root {
            --bg-color: #AA336A;
            --brush-color: #E4A5C2;
            --nav-height: 60px;
            --hero-text-size: 13vw;
            --reveal-text-size: 3.5rem;
            --final-text-size: 8vw;
            --glow-color: rgba(228, 165, 194, 0.8);
        }

        html.lenis, html.lenis body { height: auto; }
        .lenis.lenis-smooth { scroll-behavior: auto !important; }
        .lenis.lenis-smooth [data-lenis-prevent] { overscroll-behavior: contain; }
        .lenis.lenis-stopped { overflow: hidden; }
        .lenis.lenis-scrolling iframe { pointer-events: none; }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background: var(--bg-color);
            font-family: "Bricolage Grotesque", sans-serif;
            overflow-x: hidden;
            color: white;
        }

        #loader {
            position: fixed; inset: 0; background: #000; z-index: 2000;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
        }
        .loader-heart { font-size: 50px; animation: pulse 1.2s infinite; color: var(--brush-color); }
        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.3); } }
        .loader-text { margin-top: 20px; letter-spacing: 4px; font-size: 12px; color: white; text-transform: uppercase; }

        nav {
            position: fixed; top: 0; width: 100%; height: var(--nav-height);
            display: flex; justify-content: center; align-items: center; z-index: 1000;
            background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(15px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .rose-bg {
            position: fixed; inset: 0; width: 100vw; height: 100vh;
            background-size: cover; background-position: center; z-index: -1;
            pointer-events: none; filter: brightness(0.7); will-change: transform, opacity;
        }
        #rose-start { background-image: url('https://iili.io/fbWFcx4.png'); opacity: 0; transform: scale(1.3); }
        #rose-end { background-image: url('https://iili.io/fbWFIfI.png'); opacity: 0; }

        .top-text {
            font-weight: 800; line-height: 0.9; color: white;
            letter-spacing: -3px; z-index: 10; opacity: 0; text-align: left;
        }

        #hero-text { font-size: var(--hero-text-size); }

        .brush-stroke {
            position: relative; display: inline-block; padding: 0 15px; z-index: 1;
        }
        .brush-stroke::before {
            content: ""; position: absolute; top: 20%; left: 0; width: 100%; height: 75%;
            background: var(--brush-color); z-index: -1; border-radius: 150px 15px; transform: rotate(-1.2deg);
        }

        #reveal-section { justify-content: center; padding: 0 15%; }
        .reveal-text-container {
            font-size: var(--reveal-text-size); font-weight: 800; line-height: 1.4;
            color: rgba(255, 255, 255, 0.15); text-align: left;
        }
        .word { position: relative; display: inline-block; margin-right: 0.25em; }
        .marker {
            position: absolute; bottom: 0.1em; left: 0; width: 0%; height: 0.4em;
            background: var(--brush-color); z-index: -1; border-radius: 4px; opacity: 0.9;
        }

        #final-section { justify-content: center; overflow: hidden; background: transparent; }
        
        #final-text {
            font-size: var(--final-text-size);
            text-align: center;
            width: 100%;
            text-shadow: 0 0 20px var(--glow-color);
        }

        #bg-do-you {
            position: absolute; inset: 0; display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            grid-auto-rows: 50px; gap: 10px; opacity: 0.15; z-index: 1; pointer-events: none;
        }
        .tiny-do-you {
            font-size: 14px; font-weight: 900; color: var(--brush-color);
            display: flex; justify-content: center; align-items: center; text-transform: uppercase;
        }

        section { height: 100vh; width: 100vw; display: flex; align-items: center; padding: 0 10%; position: relative; }
    </style>
</head>
<body>

    <div id="loader">
        <div class="loader-heart">ðŸŽ€</div>
        <div class="loader-text">Wait MY Love Everything Loading....</div>
    </div>

    <nav>
        <div id="changing-word" style="color:var(--brush-color); font-weight: bold; text-transform: uppercase; letter-spacing: 2px;">
            LOVE
        </div>
    </nav>

    <div id="rose-start" class="rose-bg"></div>
    <div id="rose-end" class="rose-bg"></div>

    <section>
        <div class="content-wrapper" style="width: 100%;">
            <h1 class="top-text" id="hero-text">
                will you take<br><span class="brush-stroke">my rose?</span>
            </h1>
        </div>
    </section>

    <section id="reveal-section">
        <div class="reveal-text-container" id="reveal-text">
i haven't known you for long, but seen enough to know you're special. I'd like to give rose to you, will you take it? 
        </div>
    </section>

    <section id="final-section">
        <div id="bg-do-you"></div>
        <h2 class="top-text" id="final-text">Love You Always.</h2>
    </section>

    <script>
        const lenis = new Lenis();
        function raf(time) { lenis.raf(time); requestAnimationFrame(raf); }
        requestAnimationFrame(raf);

        gsap.registerPlugin(ScrollTrigger);
        lenis.on('scroll', ScrollTrigger.update);
        gsap.ticker.add((time) => { lenis.raf(time * 1000); });
        gsap.ticker.lagSmoothing(0);

        const images = ['https://iili.io/fbWFcx4.png', 'https://iili.io/fbWFIfI.png'];

        function preloadImages(urls) {
            const promises = urls.map(url => {
                return new Promise((resolve) => {
                    const img = new Image();
                    img.src = url;
                    img.onload = resolve;
                    img.onerror = resolve;
                });
            });
            return Promise.all(promises);
        }

        preloadImages(images).then(() => {
            const loader = document.getElementById('loader');
            gsap.to(loader, {
                opacity: 0, duration: 1.2, ease: "power2.inOut",
                onComplete: () => {
                    loader.style.display = 'none';
                    initAnimations();
                }
            });
        });

        function initAnimations() {
            gsap.to("#rose-start", { 
                opacity: 0.6, 
                scale: 1, 
                duration: 2.5, 
                ease: "expo.out" 
            });

            gsap.to("#hero-text", { 
                opacity: 1, 
                y: -20, 
                duration: 1.8, 
                delay: 0.5,
                ease: "expo.out" 
            });

            const textContainer = document.getElementById('reveal-text');
            const words = textContainer.innerText.split(' ');
            textContainer.innerHTML = '';   
            words.forEach(word => {
                const span = document.createElement('span');
                span.className = 'word';
                span.innerHTML = `${word}<div class="marker"></div>`;
                textContainer.appendChild(span);
                textContainer.appendChild(document.createTextNode(' '));
            });

            const doYouContainer = document.getElementById('bg-do-you');
            for(let i=0; i<150; i++) {
                const span = document.createElement('span');
                span.className = 'tiny-do-you';
                span.innerText = "Do You?";
                span.style.transform = `rotate(${Math.random() * 20 - 10}deg)`;
                doYouContainer.appendChild(span);
            }

            const scrubTl = gsap.timeline({  
                scrollTrigger: {  
                    trigger: "#reveal-section", 
                    start: "top top", 
                    end: "+=2500", 
                    pin: true, 
                    scrub: 1, 
                    anticipatePin: 1  
                }  
            });  
            
            scrubTl.to("#rose-start", { opacity: 0, scale: 1.1, duration: 2 }, 0)  
                   .to("#rose-end", { opacity: 0.6, scale: 1.3, duration: 2 }, 0);  
            
            const wordSpans = document.querySelectorAll('.word');
            wordSpans.forEach((word) => {
                const marker = word.querySelector('.marker');
                scrubTl.to(word, { color: "white", duration: 0.5 }, ">-0.2") 
                       .to(marker, { width: "100%", duration: 1, ease: "power1.inOut" }, "<");   
            });

            scrubTl.to(".rose-bg", { opacity: 0, duration: 1 });

          
            gsap.to("#final-text", {
                scrollTrigger: {
                    trigger: "#final-section", start: "top 80%",
                },
                opacity: 1, y: -20, duration: 1.5, ease: "expo.out",
                onComplete: () => {
                    gsap.to("#final-text", {
                        textShadow: "0 0 40px rgba(228, 165, 194, 1), 0 0 60px rgba(228, 165, 194, 0.4)",
                        duration: 2,
                        repeat: -1,
                        yoyo: true,
                        ease: "sine.inOut"
                    });
                }
            });
        }

        // Nav Text Rotation
        const navWords = ["Be MY Love?", "Be MY Life?", "Always Be Mine?", "Be Together?"];  
        let navIdx = 0;  
        setInterval(() => {
            const el = document.getElementById('changing-word');
            gsap.to(el, { 
                opacity: 0, y: -10, duration: 0.4, 
                onComplete: () => {  
                    navIdx = (navIdx + 1) % navWords.length;  
                    el.innerText = navWords[navIdx];  
                    gsap.fromTo(el, { opacity: 0, y: 10 }, { opacity: 1, y: 0, duration: 0.4 });  
                }
            });  
        }, 3000);
    </script>
</body>
</html>
